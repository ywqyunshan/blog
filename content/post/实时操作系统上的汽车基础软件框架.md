---
layout:     post

title:      "实时操作系统上的汽车基础软件框架"
subtitle:   "类似理想VCOS或AUTOSAR Classic Platform"
excerpt: ""
author:     "iigeoywq button"
date:       2025-11-16
published: true 
tags:
    - 系统理论 

categories: [ Tech ]
URL: "/2025/11/16/"
---

> 蔚小理自研的RTOS操作系统，其实就是基于AUTOSAR Claasic Platform 标准，自下而上构建硬件抽象层，内核，系统组件服务，RTE， 应用层。另外RTOS没有进程，都是线程（或者叫TASK），每个模块都是一个component。

## 1 系统架构
以理想的开源为VCOS例，直接上图，就这5层架构。
![vcos系统架构](/img/vcos系统架构.png)

## 2 系统组件
重点说两个系统组件，通信服务和RTE(任意两个component之间的通信方式)。
### 2.1  RTE
提供任意两个模块之间的通信接口、调度管理，并根据配置生成对应的接口。

* 提供2种通信方式：
    * Sender-Receiver（SR，发送者-接收者）：支持队列式与非队列式两种语义。
        *  队列式：写入按序入队，接收侧逐条出队处理，常用环形缓冲或队列缓冲实现。
        *  非队列式：仅保留最新值，接收侧读取当前值，无排队。
    * Client-Server（CS，客户端-服务端）：调用接口函数，典型为同步请求-响应（也可配置异步）。
* 调度Event事件，映射Runnable到Task执行。
    ![RTE_SR](/img/RTE_SR.png)

### 2.2 通信模块
#### 2.2.1 总体架构
自下而上分为六层：网络设备驱动层（net_dev）、网络协议层（net_protocols）、PDU路由层（pdu_router），网络管理（NM）和通信服务层（ComM）以及应用层（SWC）。

![网络架构](/img/rtos_NM.png)

* 网络设备驱动层 (net_dev)：位于最底层，负责对硬件设备进行抽象和封装。canif模块为CAN控制器提供统一的接口，屏蔽了不同硬件的差异性，向上层提供标准化的数据收发服务。eth模块则为以太网控制器提供类似的驱动抽象；

* 网络协议层 (net_protocols)：主要实现以太网协议，包括、IPv4、TCP和UDP，CAN数据不走这一层。

* PDU路由层 (pdu_router)：作为通信栈的核心枢纽，PDU Router负责协议数据单元的接收、分发和转发。这一层要深入研究一下。

* 网络管理层 (net_manager)：
由cannm（CAN网络管理）和cansm（CAN状态管理）以及Ethnm等模块组成，负责实现ECU的网络管理功能，包括协调ECU的睡眠（Sleep）与唤醒（Wake-up）状态转换，确保整个网络的低功耗运行。这一块就是PNC要在研究一下。

* 通信服务层（rt_com）类似AUTOSAR Com 层的承担信号处理/打包解包/通知职责。
* 应用层：应用层通过上面的RTE（运行时环境）与通信栈进行交互。

#### 2.2.2 Can通信

#### 2.2.3 网络管理-NM








